<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="PREF_OFR_SLOTS_INS_TRG" directorySegmentName="seg_0" id="3500B733-1FF1-76FF-0F00-43FDFA181CE2">
<createdBy>Bart≈Çomiej Krawczyk</createdBy>
<createdTime>2022-05-17 09:09:42 UTC</createdTime>
<ownerDesignName>BD2C049</ownerDesignName>
<actions>INSERT</actions>
<body><![CDATA[BEGIN
	IF (
		(
		SELECT 	COUNT(*) 
		FROM 	preferences p 
		WHERE 	p.course_code == new.course_code 
			AND 	p.registration_code == new.registration_code 
			AND  p.result == 'Y'
		) > (
		SELECT 	available_slots 
		FROM 	offer o 
		WHERE 	o.course_code == new.course_code 
			AND 	o.registration_code == new.registration_code
		)
	) THEN
		raise_application_error(-20001, 'Not enough slots for the offer!');
	END;
END;
/]]></body>
<triggerTime>BEFORE</triggerTime>
<condition><![CDATA[new.result == 'Y']]></condition>
<table>9ED40965-CA3E-47D8-B466-9AB66D8932DE</table>
</TriggerOraclev10g>
