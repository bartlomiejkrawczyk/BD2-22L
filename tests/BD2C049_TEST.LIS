SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Every candidate registers giving their personal information.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- Number of all the candidates accross every registration
SQL> 
SQL> SELECT  COUNT(*) NUMBER_OF_CANDIDATES
  2  FROM    candidates;

NUMBER_OF_CANDIDATES
--------------------
                1137

SQL> 
SQL> -- Personal Information
SQL> 
SQL> SELECT  candidate_id
  2      ,   first_name
  3      ,   second_name
  4      ,   family_name
  5      ,   birth_date
  6      ,   pesel
  7  FROM    candidates
  8  FETCH FIRST 20 ROWS ONLY;

CANDIDATE_ID FIRST_NAME           SECOND_NAME          FAMILY_NAME               BIRTH_DA PESEL      
------------ -------------------- -------------------- ------------------------- -------- -----------
         100 Serina                                    Larick                    77/08/21 13294916953
         101 Maribel                                   Filary                    68/11/07 42439284874
         102 Raelynn              Mikenna              Nobriga                   57/02/24            
         103 Teia                 Deirdre              Brigges                   06/12/12 76015892184
         104 Neghan               Legrande             Romas                     45/09/28 93958004840
         105 Tyffani                                   Curi                      45/09/14 93572104131
         106 Asael                                     Krzyminski                29/02/28            
         107 Silver               Elly                 Lafleche                  04/05/21 10490445119
         108 Sahira                                    Meehan                    70/03/02 72348320167
         109 Jeana                Crystel              Larcade                   59/05/24            
         110 Risha                                     Suchocki                  33/11/13 52518794421
         111 Ayme                                      Klukas                    06/02/27 42351928838
         112 Devlin                                    Mabary                    62/10/17            
         113 Nichols              Steele               Arslanian                 95/07/03 52480525648
         114 Glenn                                     Legaspi                   25/04/08            
         115 Amaryllis                                 Zubia                     60/01/01 62885138616
         116 Clementine           Ladana               Olesky                    53/03/18 73364883808
         117 Leotis                                    Colindres                 89/10/19 44670382753
         118 Savvas                                    Olquin                    32/09/25            
         119 Marni                Romney               Katnik                    24/06/27            

20 rows selected. 

SQL> 
SQL> -- Contact Information
SQL> 
SQL> SELECT  candidate_id
  2      ,   phone_number
  3      ,   email
  4  FROM    candidates
  5  FETCH FIRST 20 ROWS ONLY;

CANDIDATE_ID PHONE_NUMBER  EMAIL                                                                                               
------------ ------------- ----------------------------------------------------------------------------------------------------
         100 +35874747711  Serina.Larick.242@o2.pl                                                                             
         101 +30826760591  Maribel.Filary.1109@gmail.com                                                                       
         102 +37730909864  Raelynn.Nobriga.1289@youtube.com                                                                    
         103               Teia.Brigges.1124@youtube.com                                                                       
         104               Neghan.Romas.2012@gmail.com                                                                         
         105               Tyffani.Curi.1168@example.com                                                                       
         106 +15956081167  Asael.Krzyminski.67@youtube.com                                                                     
         107 +50468661171  Silver.Lafleche.1081@wp.pl                                                                          
         108               Sahira.Meehan.462@gmail.com                                                                         
         109               Jeana.Larcade.145@gmail.com                                                                         
         110               Risha.Suchocki.398@o2.pl                                                                            
         111               Ayme.Klukas.437@pw.edu.pl                                                                           
         112 +18722724150  Devlin.Mabary.437@pw.edu.pl                                                                         
         113               Nichols.Arslanian.235@example.com                                                                   
         114               Glenn.Legaspi.847@gmail.com                                                                         
         115               Amaryllis.Zubia.426@youtube.com                                                                     
         116               Clementine.Olesky.1356@pw.edu.pl                                                                    
         117               Leotis.Colindres.685@gmail.com                                                                      
         118               Savvas.Olquin.1767@wp.pl                                                                            
         119               Marni.Katnik.1865@youtube.com                                                                       

20 rows selected. 

SQL> 
SQL> -- Registered Address
SQL> 
SQL> SELECT  candidate_id
  2      ,   country
  3      ,   voivodeship
  4      ,   city
  5      ,   postal_code
  6      ,   street
  7      ,   home_number
  8      ,   apartment_number
  9  FROM    candidates
 10  FETCH FIRST 20 ROWS ONLY;

CANDIDATE_ID COUNTRY                                            VOIVODESHIP                                        CITY                                               POSTAL_COD STREET                                                                           HOME_N APART
------------ -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------- -------------------------------------------------------------------------------- ------ -----
         100 Lesotho                                                                                               Capitola                                           97-500     Lemon Street East                                                                30M         
         101 Mali                                               Podlaskie                                          UnionCity                                          541-228                                                                                     783O   858R 
         102 Jordan                                             Kujawsko-Pomorskie                                 Aitkin                                             959-991    Troon Terrace                                                                    433Q   425V 
         103 Botswana                                           Podkarpackie                                       ByrnesMill                                         680-521                                                                                     111F        
         104 Portugal                                                                                              Tecumseh                                           415-527                                                                                     353S   973B 
         105 Nepal                                                                                                 Cornelia                                           425-355                                                                                     2R          
         106 Angola                                             Podlaskie                                          Van                                                15-773                                                                                      774I        
         107 Uganda                                             Lodzkie                                            Poland                                             466-720    Bolton Place                                                                     330P        
         108 United Arab Emirates                               Pomorskie                                          Elfers                                             457-722    Sugar Maple Lane                                                                 519V   129G 
         109 Costa Rica                                                                                            Corydon                                            579-259    Windsong Road                                                                    134A   102G 
         110 India                                                                                                 Gassville                                          512-18     Gooseneck Road                                                                   334T        
         111 Lesotho                                                                                               HarwichCenter                                      353-937                                                                                     904V        
         112 Greece                                             Kujawsko-Pomorskie                                 Algonac                                            347-349    Hillsdale Road                                                                   117J   887E 
         113 St Lucia                                                                                              FrenchLick                                         230-580                                                                                     84I    13T  
         114 Sao Tome and Principe                              Podkarpackie                                       Lucerne                                            166-119    Halifax Street North                                                             462F   729P 
         115 Algeria                                            Warminsko-Mazurskie                                RaleighHills                                       744-611                                                                                     328O   221T 
         116 Equatorial Guinea                                  Podlaskie                                          Nephi                                              204-253                                                                                     370C   192K 
         117 Senegal                                                                                               Hazelwood                                          251-226                                                                                     21H    769L 
         118 Jamaica                                            Podlaskie                                          Banning                                            522-973                                                                                     682F   130G 
         119 Solomon Islands                                                                                       Lovettsville                                       861-967                                                                                     765W        

20 rows selected. 

SQL> 
SQL> -- Optional Information Given
SQL> 
SQL> SELECT  candidate_id
  2      ,   pesel
  3      ,   phone_number
  4      ,   second_name
  5      ,   voivodeship
  6      ,   street
  7      ,   apartment_number
  8  FROM    candidates
  9  WHERE   pesel IS NOT NULL
 10      AND phone_number IS NOT NULL
 11      AND second_name IS NOT NULL
 12      AND voivodeship IS NOT NULL
 13      AND street IS NOT NULL
 14      AND apartment_number IS NOT NULL
 15  ;

CANDIDATE_ID PESEL       PHONE_NUMBER  SECOND_NAME          VOIVODESHIP                                        STREET                                                                           APART
------------ ----------- ------------- -------------------- -------------------------------------------------- -------------------------------------------------------------------------------- -----
         341 66155077187 +39899006727  Matisha              Dolnoslaskie                                       Esmond Street                                                                    397D 
         187 55450190407 +10794632786  Devonna              Zachodniopomorskie                                 Etching Overlook                                                                 170I 
         281 44532658132 +1990827609   Sander               Swietokrzyskie                                     Ellison Avenue South                                                             779G 
         308 49986385722 +18122576951  Reginaldo            Swietokrzyskie                                     Weightman Street                                                                 209V 
         578 94955695851 +38318153765  Lakara               Podlaskie                                          Boggs Lane                                                                       975U 
         579 40212854252 +53852579363  Jemma                Kujawsko-Pomorskie                                 Tennessee Avenue North                                                           672M 
         595 20330291058 +48571517690  Bryden               Lodzkie                                            Mill Creek Road                                                                  38B  
         604 70743706636 +99390566632  Kami                 Opolskie                                           Dulcimer Lane                                                                    36V  
         690 64842390857 +47432540235  Kijuana              Warminsko-Mazurskie                                Syracuse Court South                                                             776H 
        1114 45890705143 +86807435608  Carrieann            Lodzkie                                            Shelby Way                                                                       636W 
        1174 73333315259 +80646464268  Natosha              Podkarpackie                                       Shire Mill Road                                                                  555Q 
        1208 33842201307 +48428792224  Jansen               Lubuskie                                           Oak Terrace                                                                      879O 
        1210 33673037468 +9928507686   Jamise               Kujawsko-Pomorskie                                 Harford Place                                                                    265I 
         868 35525986819 +30666322887  Teneisha             Dolnoslaskie                                       Upper Gulph Road                                                                 875C 
         892 86325388762 +84526260640  Omar                 Opolskie                                           Normandy Street                                                                  327U 
         972 50696998928 +56560582452  Yamil                Warminsko-Mazurskie                                Pear Shape Lane                                                                  748G 

16 rows selected. 

SQL> 
SQL> -- Optional Information NOT Given
SQL> 
SQL> SELECT  candidate_id
  2      ,   pesel
  3      ,   phone_number
  4      ,   second_name
  5      ,   voivodeship
  6      ,   street
  7      ,   apartment_number
  8  FROM    candidates
  9  WHERE   pesel IS NULL
 10      AND phone_number IS NULL
 11      AND second_name IS NULL
 12      AND voivodeship IS NULL
 13      AND street IS NULL
 14      AND apartment_number IS NULL
 15  ;

CANDIDATE_ID PESEL       PHONE_NUMBER  SECOND_NAME          VOIVODESHIP                                        STREET                                                                           APART
------------ ----------- ------------- -------------------- -------------------------------------------------- -------------------------------------------------------------------------------- -----
         343                                                                                                                                                                                         
         349                                                                                                                                                                                         
         196                                                                                                                                                                                         
         262                                                                                                                                                                                         
         568                                                                                                                                                                                         
         584                                                                                                                                                                                         
         620                                                                                                                                                                                         
         772                                                                                                                                                                                         
         776                                                                                                                                                                                         
         442                                                                                                                                                                                         
         443                                                                                                                                                                                         
        1032                                                                                                                                                                                         
        1142                                                                                                                                                                                         
        1157                                                                                                                                                                                         
        1190                                                                                                                                                                                         

15 rows selected. 

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Every candidate registers specifying up to 3 choosen courses of study from 
SQL> -- university offer.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- Number of placed preferences in a given registration
SQL> 
SQL> SELECT  first_name
  2      ,   second_name
  3      ,   family_name
  4      ,   registration_code
  5      ,   COUNT(*) PREFERENCES_IN_REGISTRATION
  6  FROM    candidates
  7  JOIN    preferences 
  8      USING (candidate_id)
  9  GROUP BY candidate_id
 10      ,   registration_code
 11      ,   first_name
 12      ,   second_name
 13      ,   family_name
 14  ORDER BY candidate_id ASC
 15      ,   registration_code DESC
 16  FETCH FIRST 20 ROWS ONLY;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               REGIS PREFERENCES_IN_REGISTRATION
-------------------- -------------------- ------------------------- ----- ---------------------------
Serina                                    Larick                    16W                             1
Maribel                                   Filary                    20W                             3
Maribel                                   Filary                    17W                             2
Maribel                                   Filary                    10W                             1
Raelynn              Mikenna              Nobriga                   15S                             1
Raelynn              Mikenna              Nobriga                   14S                             3
Teia                 Deirdre              Brigges                   16W                             1
Teia                 Deirdre              Brigges                   14S                             3
Neghan               Legrande             Romas                     22W                             3
Neghan               Legrande             Romas                     22S                             2
Neghan               Legrande             Romas                     18S                             2
Tyffani                                   Curi                      20W                             1
Tyffani                                   Curi                      20S                             2
Asael                                     Krzyminski                21S                             3
Silver               Elly                 Lafleche                  21S                             2
Sahira                                    Meehan                    21S                             1
Sahira                                    Meehan                    19S                             2
Sahira                                    Meehan                    17W                             3
Jeana                Crystel              Larcade                   14W                             2
Jeana                Crystel              Larcade                   10S                             2

20 rows selected. 

SQL> 
SQL> -- Check if number of chosen courses does not exceed 3 courses per registration
SQL> 
SQL> SELECT  candidate_id
  2      ,   registration_code
  3      ,   COUNT(*) PREFERENCES_IN_REGISTRATION
  4  FROM    preferences
  5  GROUP BY candidate_id
  6      ,   registration_code
  7  HAVING  COUNT(*) > 3;
no rows selected
SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- The order determines the preferences.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT  cand.first_name
  2      ,   cand.second_name
  3      ,   cand.family_name
  4      ,   registration_code
  5      ,   course_code
  6      ,   crs.name
  7      ,   pref.sequential_number
  8  FROM    candidates cand
  9  JOIN    preferences pref
 10      USING(candidate_id)
 11  JOIN    courses crs
 12      USING(course_code)
 13  WHERE   candidate_id = 101
 14  ORDER BY registration_code
 15      ,   pref.sequential_number
 16  ;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               REGIS COURSE NAME                                                                                                 SEQUENTIAL_NUMBER
-------------------- -------------------- ------------------------- ----- ------ ---------------------------------------------------------------------------------------------------- -----------------
Maribel                                   Filary                    10W   SS130  Science in Health Informatics                                                                                        1
Maribel                                   Filary                    17W   CM32   Computer Applications                                                                                                1
Maribel                                   Filary                    17W   ST129  Science in Government Contracts                                                                                      2
Maribel                                   Filary                    20W   LE77   Letters                                                                                                              1
Maribel                                   Filary                    20W   SE75   Studies in Law                                                                                                       2
Maribel                                   Filary                    20W   ST129  Science in Government Contracts                                                                                      3

6 rows selected. 

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Recruitment takes place twice a year.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- All the registrations
SQL> 
SQL> SELECT  registration_code
  2      ,   start_date
  3      ,   end_date
  4  FROM    registrations;

REGIS START_DA END_DATE
----- -------- --------
10W   10/07/01 10/07/28
10S   10/02/01 10/02/28
11W   11/07/01 11/07/28
11S   11/02/01 11/02/28
12W   12/07/01 12/07/28
12S   12/02/01 12/02/28
13W   13/07/01 13/07/28
13S   13/02/01 13/02/28
14W   14/07/01 14/07/28
14S   14/02/01 14/02/28
15W   15/07/01 15/07/28
15S   15/02/01 15/02/28
16W   16/07/01 16/07/28
16S   16/02/01 16/02/28
17W   17/07/01 17/07/28
17S   17/02/01 17/02/28
18W   18/07/01 18/07/28
18S   18/02/01 18/02/28
19W   19/07/01 19/07/28
19S   19/02/01 19/02/28
20W   20/07/01 20/07/28
20S   20/02/01 20/02/28
21W   21/07/01 21/07/28
21S   21/02/01 21/02/28
22W   22/07/01 22/07/28
22S   22/02/01 22/02/28

26 rows selected. 

SQL> 
SQL> -- Registrations from year 2022
SQL> 
SQL> SELECT  registration_code
  2      ,   start_date
  3      ,   end_date
  4  FROM    registrations
  5  WHERE   EXTRACT(YEAR FROM start_date) = 2022;

REGIS START_DA END_DATE
----- -------- --------
22W   22/07/01 22/07/28
22S   22/02/01 22/02/28

SQL> 
SQL> -- Count all the registrations per year
SQL> 
SQL> SELECT  EXTRACT(YEAR FROM start_date) YEAR
  2      ,   COUNT(*) REGISTRATIONS_IN_A_YEAR
  3  FROM    registrations
  4  GROUP BY EXTRACT(YEAR FROM start_date)
  5  ORDER BY YEAR;

      YEAR REGISTRATIONS_IN_A_YEAR
---------- -----------------------
      2010                       2
      2011                       2
      2012                       2
      2013                       2
      2014                       2
      2015                       2
      2016                       2
      2017                       2
      2018                       2
      2019                       2
      2020                       2
      2021                       2
      2022                       2

13 rows selected. 

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- The university course offer changes with time.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- List of 20 courses
SQL> SELECT  course_code
  2      ,   name
  3      ,   degree
  4      ,   CAST(
  5              CASE 
  6                  WHEN description IS NOT NULL AND LENGTH(description) > 103 THEN
  7                      SUBSTR(description, 0, 100) || '...'
  8                  WHEN description IS NOT NULL THEN
  9                      SUBSTR(description, 0, 103)
 10                  ELSE 
 11                      NULL
 12              END 
 13              AS VARCHAR2(103)
 14          ) DESCRIPTION
 15  FROM courses
 16  FETCH FIRST 20 ROWS ONLY;

COURSE NAME                                                                                                 D DESCRIPTION                                                                                            
------ ---------------------------------------------------------------------------------------------------- - -------------------------------------------------------------------------------------------------------
AC0    Accountancy                                                                                          D Etincidunt dolor adipisci dolore non ut etincidunt sit. Tempora aliquam amet aliquam magnam. Neque t...
AE1    Accounting and Information Systems                                                                   E                                                                                                        
AA2    Advanced Study                                                                                       M Aliquam dolor ut quisquam consectetur adipisci ipsum aliquam. Porro labore voluptatem dolor adipisci...
AO3    Agricultural Economics                                                                               B Sit sit eius sit non velit ut quiquia. Adipisci ipsum eius est. Quaerat sed magnam consectetur. Quae...
AM4    Applied Economics                                                                                    M Velit etincidunt adipisci est dolorem. Voluptatem quisquam magnam sed porro adipisci. Consectetur ma...
AP5    Applied Finance                                                                                      E Porro labore sed est sit. Velit modi tempora dolorem quisquam. Eius est consectetur non dolore. Ut d...
AL6    Applied Mathematical Sciences                                                                        M                                                                                                        
AY7    Applied Psychology                                                                                   E                                                                                                        
AI8    Applied Science                                                                                      M                                                                                                        
AT9    Architecture                                                                                         E                                                                                                        
AS10   Arts                                                                                                 D                                                                                                        
AN11   Arts in Archives and Records Management                                                              D Tempora aliquam dolore voluptatem. Dolor tempora dolorem tempora quaerat tempora. Labore porro quiqu...
AH12   Arts in Bioethics                                                                                    E Porro velit non dolorem neque ipsum adipisci neque. Ut velit modi adipisci. Sit modi etincidunt ipsu...
AB13   Arts in Liberal Studies                                                                              B                                                                                                        
AE14   Arts in Museum Studies                                                                               D Porro etincidunt voluptatem dolor. Amet voluptatem est sed amet voluptatem. Dolor ut velit modi volu...
AI15   Arts in Strategic Communication Management                                                           D Velit ipsum porro neque. Neque ipsum dolor est quiquia quaerat aliquam porro. Labore dolor dolore la...
AS16   Arts in Teaching                                                                                     B                                                                                                        
AT17   Athletic Training                                                                                    B                                                                                                        
BT18   Bioethics                                                                                            E                                                                                                        
BI19   Bioinformatics                                                                                       D Eius quaerat sed neque. Modi quisquam amet adipisci ipsum tempora dolore. Velit eius magnam dolor do...

20 rows selected. 

SQL> 
SQL> -- Courses and their number of occurences in all the registrations
SQL> 
SQL> SELECT  course_code
  2      ,   crs.name
  3      ,   COUNT(*) OCCURRENCES
  4  FROM    courses crs
  5  JOIN    offers ofr
  6      USING(course_code)
  7  GROUP BY course_code, crs.name
  8  FETCH FIRST 20 ROWS ONLY;

COURSE NAME                                                                                                 OCCURRENCES
------ ---------------------------------------------------------------------------------------------------- -----------
DV40   Development Economics                                                                                         10
EN42   Economics                                                                                                     14
ET44   Educational Technology                                                                                        17
AN11   Arts in Archives and Records Management                                                                       13
AT9    Architecture                                                                                                  12
BE25   Business Engineering                                                                                          14
BT18   Bioethics                                                                                                     12
CI27   Chemistry                                                                                                     15
MC90   Military Art and Science                                                                                      11
ME80   Management                                                                                                    12
MP86   Mathematics and Philosophy                                                                                     9
PL104  Public Health                                                                                                 11
PN105  Public Management                                                                                             14
PY94   Pharmacy                                                                                                      12
SC131  Science in Human Resource Development                                                                         12
SO115  Sacred Theology                                                                                               17
SO124  Science in Education                                                                                          14
SQ139  Science in Quality Assurance                                                                                  15
SS130  Science in Health Informatics                                                                                 16
SE123  Science in Cyber Security                                                                                     15

20 rows selected. 

SQL> 
SQL> -- Occurrence of a course throughout all the registrations
SQL> 
SQL> SELECT  crs.course_code
  2      ,   crs.name
  3      ,   reg.registration_code
  4      ,   start_date
  5      ,   end_date
  6  FROM    registrations reg
  7  LEFT JOIN offers ofr
  8      ON  reg.registration_code = ofr.registration_code 
  9      AND ofr.course_code = (
 10          SELECT  course_code 
 11          FROM    courses 
 12          ORDER BY course_code DESC 
 13          FETCH FIRST 1 ROW ONLY
 14      )
 15  LEFT JOIN courses crs
 16      ON ofr.course_code = crs.course_code
 17  ORDER BY start_date;

COURSE NAME                                                                                                 REGIS START_DA END_DATE
------ ---------------------------------------------------------------------------------------------------- ----- -------- --------
                                                                                                            10S   10/02/01 10/02/28
                                                                                                            10W   10/07/01 10/07/28
VA155  Veterinary Science                                                                                   11S   11/02/01 11/02/28
                                                                                                            11W   11/07/01 11/07/28
                                                                                                            12S   12/02/01 12/02/28
                                                                                                            12W   12/07/01 12/07/28
                                                                                                            13S   13/02/01 13/02/28
                                                                                                            13W   13/07/01 13/07/28
                                                                                                            14S   14/02/01 14/02/28
VA155  Veterinary Science                                                                                   14W   14/07/01 14/07/28
VA155  Veterinary Science                                                                                   15S   15/02/01 15/02/28
VA155  Veterinary Science                                                                                   15W   15/07/01 15/07/28
VA155  Veterinary Science                                                                                   16S   16/02/01 16/02/28
                                                                                                            16W   16/07/01 16/07/28
VA155  Veterinary Science                                                                                   17S   17/02/01 17/02/28
VA155  Veterinary Science                                                                                   17W   17/07/01 17/07/28
VA155  Veterinary Science                                                                                   18S   18/02/01 18/02/28
                                                                                                            18W   18/07/01 18/07/28
                                                                                                            19S   19/02/01 19/02/28
VA155  Veterinary Science                                                                                   19W   19/07/01 19/07/28
                                                                                                            20S   20/02/01 20/02/28
VA155  Veterinary Science                                                                                   20W   20/07/01 20/07/28
                                                                                                            21S   21/02/01 21/02/28
VA155  Veterinary Science                                                                                   21W   21/07/01 21/07/28
VA155  Veterinary Science                                                                                   22S   22/02/01 22/02/28
VA155  Veterinary Science                                                                                   22W   22/07/01 22/07/28

26 rows selected. 

SQL> 
SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Candidate who has not been admitted to study in a registration may start
SQL> -- in the next registrations.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- Candidates and their number of tries in registrations
SQL> 
SQL> SELECT  first_name
  2      ,   second_name
  3      ,   family_name
  4      ,   COUNT(DISTINCT registration_code) ATTENDED_REGISTRATIONS
  5  FROM    candidates
  6  JOIN    preferences 
  7      USING (candidate_id)
  8  GROUP BY candidate_id
  9      ,   first_name
 10      ,   second_name
 11      ,   family_name
 12  ORDER BY candidate_id ASC
 13  FETCH FIRST 20 ROWS ONLY;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               ATTENDED_REGISTRATIONS
-------------------- -------------------- ------------------------- ----------------------
Serina                                    Larick                                         1
Maribel                                   Filary                                         3
Raelynn              Mikenna              Nobriga                                        2
Teia                 Deirdre              Brigges                                        2
Neghan               Legrande             Romas                                          3
Tyffani                                   Curi                                           2
Asael                                     Krzyminski                                     1
Silver               Elly                 Lafleche                                       1
Sahira                                    Meehan                                         3
Jeana                Crystel              Larcade                                        2
Risha                                     Suchocki                                       2
Ayme                                      Klukas                                         2
Devlin                                    Mabary                                         1
Nichols              Steele               Arslanian                                      3
Glenn                                     Legaspi                                        3
Amaryllis                                 Zubia                                          1
Clementine           Ladana               Olesky                                         3
Leotis                                    Colindres                                      1
Savvas                                    Olquin                                         2
Marni                Romney               Katnik                                         1

20 rows selected. 

SQL> 
SQL> -- Candidates and registrations they attended
SQL> 
SQL> SELECT  first_name
  2      ,   second_name
  3      ,   family_name
  4      ,   registration_code
  5  FROM    candidates
  6  JOIN    preferences 
  7      USING (candidate_id)
  8  GROUP BY candidate_id
  9      ,   registration_code
 10      ,   first_name
 11      ,   second_name
 12      ,   family_name
 13  ORDER BY candidate_id ASC
 14      ,   registration_code
 15  FETCH FIRST 20 ROWS ONLY;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               REGIS
-------------------- -------------------- ------------------------- -----
Serina                                    Larick                    16W  
Maribel                                   Filary                    10W  
Maribel                                   Filary                    17W  
Maribel                                   Filary                    20W  
Raelynn              Mikenna              Nobriga                   14S  
Raelynn              Mikenna              Nobriga                   15S  
Teia                 Deirdre              Brigges                   14S  
Teia                 Deirdre              Brigges                   16W  
Neghan               Legrande             Romas                     18S  
Neghan               Legrande             Romas                     22S  
Neghan               Legrande             Romas                     22W  
Tyffani                                   Curi                      20S  
Tyffani                                   Curi                      20W  
Asael                                     Krzyminski                21S  
Silver               Elly                 Lafleche                  21S  
Sahira                                    Meehan                    17W  
Sahira                                    Meehan                    19S  
Sahira                                    Meehan                    21S  
Jeana                Crystel              Larcade                   10S  
Jeana                Crystel              Larcade                   14W  

20 rows selected. 

SQL> 
SQL> 
SQL> 
SQL> spool off
