SQL> 
SQL> SAVEPOINT before_tests;

Savepoint created.

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                          TEST INSERT ON CANDIDATES                         --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> INSERT INTO candidates 
  2  VALUES (99
  3      ,   'Johny.Test.1@example.com'
  4      ,   TO_DATE('2001-04-08', 'YYYY-MM-DD')
  5      ,   'Johny'
  6      ,   'Test'
  7      ,   'Poland'
  8      ,   'Warsaw'
  9      ,   '97-500'
 10      ,   '28'
 11      ,   '42439284872'
 12      ,   '+35874747711'
 13      ,   'Jacob'
 14      ,   'Mazowieckie'
 15      ,   'Lemon Street East'
 16      ,   '52'
 17  );

1 row inserted.

SQL> 
SQL> -- Optional values do not have to be set
SQL> INSERT INTO candidates (
  2          candidate_id
  3      ,   email
  4      ,   birth_date
  5      ,   first_name
  6      ,   family_name
  7      ,   country
  8      ,   city
  9      ,   postal_code
 10      ,   home_number
 11  )
 12  VALUES (98
 13      ,   'Jacob.Tested.2@example.com'
 14      ,   TO_DATE('2001-04-09', 'YYYY-MM-DD')
 15      ,   'Jacob'
 16      ,   'Tested'
 17      ,   'Poland'
 18      ,   'Warsaw'
 19      ,   '96-101'
 20      ,   '29'
 21  );

1 row inserted.

SQL> 
SQL> 
SQL> -------------------------------
SQL> -- TEST UNIQUE CAND_EMAIL_UK --
SQL> -------------------------------
SQL> 
SQL> -- Inserting same email twice should result in an error
SQL> INSERT INTO candidates (
  2          candidate_id
  3      ,   email
  4      ,   birth_date
  5      ,   first_name
  6      ,   family_name
  7      ,   country
  8      ,   city
  9      ,   postal_code
 10      ,   home_number
 11  )
 12  VALUES (97
 13      ,   'Jacob.Tested.2@example.com'
 14      ,   TO_DATE('2001-04-09', 'YYYY-MM-DD')
 15      ,   'Jacob'
 16      ,   'Tested'
 17      ,   'Poland'
 18      ,   'Warsaw'
 19      ,   '96-101'
 20      ,   '29'
 21  );

Error starting at line : 59 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO candidates (
        candidate_id
    ,   email
    ,   birth_date
    ,   first_name
    ,   family_name
    ,   country
    ,   city
    ,   postal_code
    ,   home_number
)
VALUES (97
    ,   'Jacob.Tested.2@example.com'
    ,   TO_DATE('2001-04-09', 'YYYY-MM-DD')
    ,   'Jacob'
    ,   'Tested'
    ,   'Poland'
    ,   'Warsaw'
    ,   '96-101'
    ,   '29'
)
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.CAND_EMAIL_UK)

SQL> 
SQL> -------------------------------
SQL> -- TEST UNIQUE CAND_PESEL_UK --
SQL> -------------------------------
SQL> 
SQL> -- Inserting same pesel twice should result in an error
SQL> INSERT INTO candidates (
  2          candidate_id
  3      ,   email
  4      ,   birth_date
  5      ,   first_name
  6      ,   family_name
  7      ,   country
  8      ,   city
  9      ,   postal_code
 10      ,   home_number
 11      ,   pesel
 12  )
 13  VALUES (96
 14      ,   'Johny.Test.2@example.com'
 15      ,   TO_DATE('2001-04-10', 'YYYY-MM-DD')
 16      ,   'Johny'
 17      ,   'Test'
 18      ,   'Poland'
 19      ,   'Warsaw'
 20      ,   '96-102'
 21      ,   '30'
 22      ,   '42439284872'
 23  );

Error starting at line : 86 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO candidates (
        candidate_id
    ,   email
    ,   birth_date
    ,   first_name
    ,   family_name
    ,   country
    ,   city
    ,   postal_code
    ,   home_number
    ,   pesel
)
VALUES (96
    ,   'Johny.Test.2@example.com'
    ,   TO_DATE('2001-04-10', 'YYYY-MM-DD')
    ,   'Johny'
    ,   'Test'
    ,   'Poland'
    ,   'Warsaw'
    ,   '96-102'
    ,   '30'
    ,   '42439284872'
)
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.CAND_PESEL_UK)

SQL> 
SQL> 
SQL> -------------------------------
SQL> -- TEST SEQUENCE CAND_ID_SEQ --
SQL> -------------------------------
SQL> 
SQL> DECLARE
  2      v_id NUMBER;
  3      v_seq NUMBER;
  4  BEGIN
  5      -- When id isn't specified candidate should acquire a id from sequence
  6      INSERT INTO candidates (
  7              email
  8          ,   birth_date
  9          ,   first_name
 10          ,   family_name
 11          ,   country
 12          ,   city
 13          ,   postal_code
 14          ,   home_number
 15      )
 16      VALUES ('Jack.TestED.3@example.com'
 17          ,   TO_DATE('2001-04-10', 'YYYY-MM-DD')
 18          ,   'Jack'
 19          ,   'TestED'
 20          ,   'Poland'
 21          ,   'Warsaw'
 22          ,   '96-101'
 23          ,   '31'
 24      ) RETURNING candidate_id INTO v_id;
 25  
 26      SELECT CAND_ID_SEQ.CURRVAL INTO v_seq FROM DUAL;
 27  
 28      IF v_id != v_seq THEN
 29          raise_application_error(-20010, 'Id: '|| v_id
 30              || ' is not equal last value from sequence: '|| v_seq);
 31      END IF;
 32  
 33      IF v_id < 10000 OR v_id > 9999999 THEN
 34          raise_application_error(-20011, 'ID out of specified bounds!');
 35      END IF;
 36  END;
 37  /

PL/SQL procedure successfully completed.

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                          TEST INSERT ON COURSES                            --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> INSERT INTO courses
  2  VALUES ('TEST1'
  3      ,   'Science of Testing, Finding Buggs and Debugging'
  4      ,   'D'
  5      ,   'Lorem ipsum dolor sit amet, consectetur adipiscing elit.'
  6  );

1 row inserted.

SQL> 
SQL> INSERT INTO courses
  2  VALUES ('TEST2'
  3      ,   'Mechatronics of Vehicles, Construction Machinery and Computer Science'
  4      ,   'E'
  5      ,   NULL
  6  );

1 row inserted.

SQL> 
SQL> -----------------------------
SQL> -- TEST UNIQUE CRS_NAME_UK --
SQL> -----------------------------
SQL> 
SQL> -- Inserting same name twice should result in an error
SQL> INSERT INTO courses
  2  VALUES ('TEST3'
  3      ,   'Science of Testing, Finding Buggs and Debugging'
  4      ,   'B'
  5      ,   NULL
  6  );

Error starting at line : 176 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO courses
VALUES ('TEST3'
    ,   'Science of Testing, Finding Buggs and Debugging'
    ,   'B'
    ,   NULL
)
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.CRS_NAME_UK)

SQL> 
SQL> -------------------------------
SQL> -- TEST CHECK CRS_CHK_DEGREE --
SQL> -------------------------------
SQL> 
SQL> -- Check if all possible degrees are inserted correctly
SQL> INSERT INTO courses VALUES ('1', 'Bachelor', 'B',   NULL);

1 row inserted.

SQL> INSERT INTO courses VALUES ('2', 'Doctorate', 'D',   NULL);

1 row inserted.

SQL> INSERT INTO courses VALUES ('3', 'Engineer', 'E',   NULL);

1 row inserted.

SQL> INSERT INTO courses VALUES ('4', 'Master', 'M',   NULL);

1 row inserted.

SQL> 
SQL> -- Degree set to values other than BDEM should result in an error
SQL> INSERT INTO courses VALUES ('5', 'Degree Error', 'R',   NULL);

Error starting at line : 194 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO courses VALUES ('5', 'Degree Error', 'R',   NULL)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.CRS_CHK_DEGREE)

SQL> INSERT INTO courses VALUES ('5', 'Degree Error', 'b',   NULL);

Error starting at line : 195 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO courses VALUES ('5', 'Degree Error', 'b',   NULL)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.CRS_CHK_DEGREE)

SQL> 
SQL> -----------------------------------
SQL> -- TEST CHECK CRS_CHK_CODE_UPPER --
SQL> -----------------------------------
SQL> 
SQL> -- Course code not in uppercase should result in an error
SQL> INSERT INTO courses VALUES ('TeST', 'Code Error', 'B',   NULL);

Error starting at line : 202 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO courses VALUES ('TeST', 'Code Error', 'B',   NULL)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.CRS_CHK_CODE_UPPER)

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                         TEST INSERT ON REGISTRATIONS                       --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> INSERT INTO registrations
  2  VALUES (
  3          '99S'
  4      ,   TO_DATE('1999-02-01', 'YYYY-MM-DD')
  5      ,   TO_DATE('1999-03-01', 'YYYY-MM-DD')
  6  );

1 row inserted.

SQL> 
SQL> -----------------------------------------
SQL> -- TEST CHECK REG_CHK_START_BEFORE_END --
SQL> -----------------------------------------
SQL> 
SQL> -- When trying to insert start date after the end date program should 
SQL> -- signal an error
SQL> INSERT INTO registrations
  2  VALUES (
  3          '99W'
  4      ,   TO_DATE('1999-03-01', 'YYYY-MM-DD')
  5      ,   TO_DATE('1999-01-01', 'YYYY-MM-DD')
  6  );

Error starting at line : 221 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO registrations
VALUES (
        '99W'
    ,   TO_DATE('1999-03-01', 'YYYY-MM-DD')
    ,   TO_DATE('1999-01-01', 'YYYY-MM-DD')
)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.REG_CHK_START_BEFORE_END)

SQL> 
SQL> -----------------------------------
SQL> -- TEST CHECK REG_CHK_CODE_UPPER --
SQL> -----------------------------------
SQL> 
SQL> -- Registration code not in uppercase should result in an error
SQL> INSERT INTO registrations
  2  VALUES (
  3          '98s'
  4      ,   TO_DATE('1998-01-01', 'YYYY-MM-DD')
  5      ,   TO_DATE('1998-02-01', 'YYYY-MM-DD')
  6  );

Error starting at line : 233 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO registrations
VALUES (
        '98s'
    ,   TO_DATE('1998-01-01', 'YYYY-MM-DD')
    ,   TO_DATE('1998-02-01', 'YYYY-MM-DD')
)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.REG_CHK_CODE_UPPER)

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                           TEST INSERT ON OFFERS                            --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> INSERT INTO offers
  2  VALUES (
  3          '99S'
  4      ,   'TEST1'
  5      ,   100
  6  );

1 row inserted.

SQL> 
SQL> -- Trying to insert second instance of the same course in a registration 
SQL> -- should result in an error
SQL> INSERT INTO offers
  2  VALUES (
  3          '99S'
  4      ,   'TEST1'
  5      ,   120
  6  );

Error starting at line : 253 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO offers
VALUES (
        '99S'
    ,   'TEST1'
    ,   120
)
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.OFR_PK)

SQL> 
SQL> ----------------------------------------
SQL> -- TEST CHECK OFR_CHK_AVAILABLE_SLOTS --
SQL> ----------------------------------------
SQL> 
SQL> -- Trying insert negative available slots should result in an error
SQL> INSERT INTO offers
  2  VALUES (
  3          '99S'
  4      ,   'TEST2'
  5      ,   -100
  6  );

Error starting at line : 265 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO offers
VALUES (
        '99S'
    ,   'TEST2'
    ,   -100
)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.OFR_CHK_AVAILABLE_SLOTS)

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                        TEST INSERT ON PREFERENCES                          --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> INSERT INTO registrations
  2  VALUES (
  3          'TEST'
  4      ,   ADD_MONTHS(SYSDATE, -1)
  5      ,   ADD_MONTHS(SYSDATE, 1)
  6  );

1 row inserted.

SQL> 
SQL> INSERT INTO offers
  2  VALUES (
  3          'TEST'
  4      ,   'TEST1'
  5      ,   100
  6  );

1 row inserted.

SQL> 
SQL> INSERT INTO offers
  2  VALUES (
  3          'TEST'
  4      ,   'TEST2'
  5      ,   1
  6  );

1 row inserted.

SQL> 
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('TEST'
  8      ,   'TEST1'
  9      ,   99
 10      ,   1
 11  );

1 row inserted.

SQL> 
SQL> -------------------------------------------
SQL> -- TEST UNIQUE PREF_SEQUENTIAL_NUMBER_UK --
SQL> -------------------------------------------
SQL> 
SQL> -- Two preferences cannot have the same sequencial number
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('TEST'
  8      ,   'TEST2'
  9      ,   99
 10      ,   1
 11  );

Error starting at line : 314 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO preferences (
        registration_code
    ,   course_code
    ,   candidate_id
    ,   sequential_number
)
VALUES ('TEST'
    ,   'TEST2'
    ,   99
    ,   1
)
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.PREF_SEQUENTIAL_NUMBER_UK)

SQL> 
SQL> -------------------------------------------
SQL> -- TEST CHECK PREF_CHK_SEQUENTIAL_NUMBER --
SQL> -------------------------------------------
SQL> 
SQL> -- Number of preference should be in range [1; 3] otherwise error 
SQL> -- should occur
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('TEST'
  8      ,   'TEST1'
  9      ,   98
 10      ,   4
 11  );

Error starting at line : 332 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO preferences (
        registration_code
    ,   course_code
    ,   candidate_id
    ,   sequential_number
)
VALUES ('TEST'
    ,   'TEST1'
    ,   98
    ,   4
)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.PREF_CHK_SEQUENTIAL_NUMBER)

SQL> 
SQL> -- Number of preference should be in range [1; 3] otherwise error 
SQL> -- should occur
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('TEST'
  8      ,   'TEST1'
  9      ,   98
 10      ,   -1
 11  );

Error starting at line : 346 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO preferences (
        registration_code
    ,   course_code
    ,   candidate_id
    ,   sequential_number
)
VALUES ('TEST'
    ,   'TEST1'
    ,   98
    ,   -1
)
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.PREF_CHK_SEQUENTIAL_NUMBER)

SQL> 
SQL> -------------------------------
SQL> -- TEST TRIGGER PREF_REG_TRG --
SQL> -------------------------------
SQL> 
SQL> -- Trying to enroll in previous registrations should result in an error
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('99S'
  8      ,   'TEST1'
  9      ,   99
 10      ,   1
 11  );

Error starting at line : 363 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO preferences (
        registration_code
    ,   course_code
    ,   candidate_id
    ,   sequential_number
)
VALUES ('99S'
    ,   'TEST1'
    ,   99
    ,   1
)
Error report -
ORA-20002: Cannot insert preference for closed (or not open yet) registration
ORA-06512: przy "BD2C049.PREF_REG_TRG", linia 19
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.PREF_REG_TRG'

SQL> 
SQL> INSERT INTO registrations
  2  VALUES (
  3          'TESTF'
  4      ,   ADD_MONTHS(SYSDATE, 12 * 100)
  5      ,   ADD_MONTHS(SYSDATE, 13 * 100)
  6  );

1 row inserted.

SQL> 
SQL> INSERT INTO offers
  2  VALUES (
  3          'TESTF'
  4      ,   'TEST1'
  5      ,   100
  6  );

1 row inserted.

SQL> 
SQL> -- Trying to enroll in future registrations should result in an error
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('TESTF'
  8      ,   'TEST1'
  9      ,   99
 10      ,   1
 11  );

Error starting at line : 390 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO preferences (
        registration_code
    ,   course_code
    ,   candidate_id
    ,   sequential_number
)
VALUES ('TESTF'
    ,   'TEST1'
    ,   99
    ,   1
)
Error report -
ORA-20002: Cannot insert preference for closed (or not open yet) registration
ORA-06512: przy "BD2C049.PREF_REG_TRG", linia 19
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.PREF_REG_TRG'

SQL> 
SQL> ----------------------------------
SQL> -- TEST TRIGGER PREF_RESULT_TRG --
SQL> ----------------------------------
SQL> 
SQL> -- Trying to insert preference with a result should result in an error
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6      ,   result
  7  )
  8  VALUES ('TEST'
  9      ,   'TEST1'
 10      ,   98
 11      ,   1
 12      ,   'Y'
 13  );

Error starting at line : 407 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
INSERT INTO preferences (
        registration_code
    ,   course_code
    ,   candidate_id
    ,   sequential_number
    ,   result
)
VALUES ('TEST'
    ,   'TEST1'
    ,   98
    ,   1
    ,   'Y'
)
Error report -
ORA-20003: Cannot add results when the registration has not finished yet!
ORA-06512: przy "BD2C049.PREF_RESULT_TRG", linia 18
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.PREF_RESULT_TRG'

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                          TEST UPDATE ON CANDIDATES                         --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> 
SQL> SELECT  candidate_id
  2      ,   email
  3      ,   pesel
  4  FROM candidates
  5  WHERE candidate_id IN (99, 98);

CANDIDATE_ID EMAIL                                                                                                PESEL      
------------ ---------------------------------------------------------------------------------------------------- -----------
          98 Jacob.Tested.2@example.com                                                                                      
          99 Johny.Test.1@example.com                                                                             42439284872

SQL> 
SQL> -------------------------------
SQL> -- TEST UNIQUE CAND_EMAIL_UK --
SQL> -------------------------------
SQL> 
SQL> UPDATE  candidates
  2  SET     email = 'Jacob.Tested.2@example.com'
  3  WHERE   candidate_id = 99;

Error starting at line : 436 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  candidates
SET     email = 'Jacob.Tested.2@example.com'
WHERE   candidate_id = 99
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.CAND_EMAIL_UK)

SQL> 
SQL> -------------------------------
SQL> -- TEST UNIQUE CAND_PESEL_UK --
SQL> -------------------------------
SQL> 
SQL> UPDATE  candidates
  2  SET     pesel = '42439284872'
  3  WHERE   candidate_id = 98;

Error starting at line : 444 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  candidates
SET     pesel = '42439284872'
WHERE   candidate_id = 98
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.CAND_PESEL_UK)

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                          TEST UPDATE ON COURSES                            --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT  course_code
  2      ,   name
  3  FROM    courses
  4  WHERE   SUBSTR(course_code, 1, 4) = 'TEST';

COURSE NAME                                                                                                
------ ----------------------------------------------------------------------------------------------------
TEST1  Science of Testing, Finding Buggs and Debugging                                                     
TEST2  Mechatronics of Vehicles, Construction Machinery and Computer Science                               

SQL> 
SQL> -----------------------------
SQL> -- TEST UNIQUE CRS_NAME_UK --
SQL> -----------------------------
SQL> 
SQL> -- Updating names so that a name appears twice should result in an error
SQL> UPDATE  courses
  2  SET     name = 'Science of Testing, Finding Buggs and Debugging'
  3  WHERE   course_code = 'TEST2';

Error starting at line : 462 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  courses
SET     name = 'Science of Testing, Finding Buggs and Debugging'
WHERE   course_code = 'TEST2'
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.CRS_NAME_UK)

SQL> 
SQL> -------------------------------
SQL> -- TEST CHECK CRS_CHK_DEGREE --
SQL> -------------------------------
SQL> 
SQL> -- Check if all possible degrees are updated correctly
SQL> UPDATE  courses
  2  SET     degree = 'D'
  3  WHERE   course_code = '1';

1 row updated.

SQL> 
SQL> UPDATE  courses
  2  SET     degree = 'E'
  3  WHERE   course_code = '1';

1 row updated.

SQL> 
SQL> UPDATE  courses
  2  SET     degree = 'M'
  3  WHERE   course_code = '1';

1 row updated.

SQL> 
SQL> UPDATE  courses
  2  SET     degree = 'B'
  3  WHERE   course_code = '1';

1 row updated.

SQL> 
SQL> -- Degree set to values other than BDEM should result in an error
SQL> UPDATE  courses
  2  SET     degree = 'b'
  3  WHERE   course_code = '1';

Error starting at line : 488 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  courses
SET     degree = 'b'
WHERE   course_code = '1'
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.CRS_CHK_DEGREE)

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                         TEST UPDATE ON REGISTRATIONS                       --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> INSERT INTO registrations
  2  VALUES (
  3          '1901S'
  4      ,   TO_DATE('1901-02-01', 'YYYY-MM-DD')
  5      ,   TO_DATE('1901-03-01', 'YYYY-MM-DD')
  6  );

1 row inserted.

SQL> 
SQL> -----------------------------------------
SQL> -- TEST CHECK REG_CHK_START_BEFORE_END --
SQL> -----------------------------------------
SQL> 
SQL> -- When trying to update start date after the end date program should 
SQL> -- signal an error
SQL> UPDATE registrations
  2  SET start_date = TO_DATE('1901-04-01', 'YYYY-MM-DD')
  3  WHERE registration_code = '1901S';

Error starting at line : 509 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE registrations
SET start_date = TO_DATE('1901-04-01', 'YYYY-MM-DD')
WHERE registration_code = '1901S'
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.REG_CHK_START_BEFORE_END)

SQL> 
SQL> -- When trying to update end date before the start date program should 
SQL> -- signal an error
SQL> UPDATE registrations
  2  SET end_date = TO_DATE('1900-12-01', 'YYYY-MM-DD')
  3  WHERE registration_code = '1901S';

Error starting at line : 515 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE registrations
SET end_date = TO_DATE('1900-12-01', 'YYYY-MM-DD')
WHERE registration_code = '1901S'
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.REG_CHK_START_BEFORE_END)

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                           TEST UPDATE ON OFFERS                            --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT  *
  2  FROM    offers
  3  WHERE   registration_code = '99S'
  4      AND course_code = 'TEST1';

REGIS COURSE AVAILABLE_SLOTS
----- ------ ---------------
99S   TEST1              100

SQL> 
SQL> UPDATE  offers
  2  SET     available_slots = 101
  3  WHERE   registration_code = '99S'
  4      AND course_code = 'TEST1';

1 row updated.

SQL> 
SQL> ----------------------------------------
SQL> -- TEST CHECK OFR_CHK_AVAILABLE_SLOTS --
SQL> ----------------------------------------
SQL> 
SQL> -- Trying update available slots to negative value should result in an error
SQL> UPDATE  offers
  2  SET     available_slots = -100
  3  WHERE   registration_code = '99S'
  4      AND course_code = 'TEST1';

Error starting at line : 538 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  offers
SET     available_slots = -100
WHERE   registration_code = '99S'
    AND course_code = 'TEST1'
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.OFR_CHK_AVAILABLE_SLOTS)

SQL> 
SQL> -------------------------------
SQL> -- TEST TRIGGER FKNTM_OFFERS --
SQL> -------------------------------
SQL> 
SQL> -- Test for non-transferability
SQL> -- Updating to previous value is OK
SQL> -- Setting different value should result in an error
SQL> UPDATE  offers
  2  SET     registration_code = '99S' 
  3  WHERE   registration_code = '99S'
  4      AND course_code = 'TEST1';

1 row updated.

SQL> 
SQL> UPDATE  offers
  2  SET     registration_code = '99A' 
  3  WHERE   registration_code = '99S'
  4      AND course_code = 'TEST1';

Error starting at line : 555 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  offers
SET     registration_code = '99A' 
WHERE   registration_code = '99S'
    AND course_code = 'TEST1'
Error report -
ORA-20225: Non Transferable FK constraint  on table OFFERS is violated
ORA-06512: przy "BD2C049.FKNTM_OFFERS", linia 2
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.FKNTM_OFFERS'

SQL> 
SQL> UPDATE  offers
  2  SET     course_code = 'TEST1'
  3  WHERE   registration_code = '99S'
  4      AND course_code = 'TEST1';

1 row updated.

SQL> 
SQL> UPDATE  offers
  2  SET     course_code = 'TEST2'
  3  WHERE   registration_code = '99S'
  4      AND course_code = 'TEST1';

Error starting at line : 565 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  offers
SET     course_code = 'TEST2'
WHERE   registration_code = '99S'
    AND course_code = 'TEST1'
Error report -
ORA-20225: Non Transferable FK constraint  on table OFFERS is violated
ORA-06512: przy "BD2C049.FKNTM_OFFERS", linia 2
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.FKNTM_OFFERS'

SQL> 
SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                        TEST UPDATE ON PREFERENCES                          --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('TEST'
  8      ,   'TEST1'
  9      ,   98
 10      ,   1
 11  );

1 row inserted.

SQL> 
SQL> INSERT INTO preferences (
  2          registration_code
  3      ,   course_code
  4      ,   candidate_id
  5      ,   sequential_number
  6  )
  7  VALUES ('TEST'
  8      ,   'TEST2'
  9      ,   98
 10      ,   2
 11  );

1 row inserted.

SQL> 
SQL> -------------------------------------------
SQL> -- TEST UNIQUE PREF_SEQUENTIAL_NUMBER_UK --
SQL> -------------------------------------------
SQL> 
SQL> -- Two preferences cannot have the same sequencial number
SQL> UPDATE  preferences
  2  SET     sequential_number = 2
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98;

Error starting at line : 604 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     sequential_number = 2
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-00001: naruszono wiêzy unikatowe (BD2C049.PREF_SEQUENTIAL_NUMBER_UK)

SQL> 
SQL> -------------------------------------------
SQL> -- TEST CHECK PREF_CHK_SEQUENTIAL_NUMBER --
SQL> -------------------------------------------
SQL> 
SQL> -- Number of preference should be in range [1; 3] otherwise error 
SQL> -- should occur
SQL> UPDATE  preferences
  2  SET     sequential_number = 4
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98;

Error starting at line : 616 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     sequential_number = 4
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.PREF_CHK_SEQUENTIAL_NUMBER)

SQL> 
SQL> -- Number of preference should be in range [1; 3] otherwise error 
SQL> -- should occur
SQL> UPDATE  preferences
  2  SET     sequential_number = -1
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98;

Error starting at line : 624 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     sequential_number = -1
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-02290: naruszono wiêzy CHECK (BD2C049.PREF_CHK_SEQUENTIAL_NUMBER)

SQL> 
SQL> 
SQL> ----------------------------------
SQL> -- TEST TRIGGER PREF_RESULT_TRG --
SQL> ----------------------------------
SQL> 
SQL> -- Trying to update preference's result when registration is still open 
SQL> -- should result in an error
SQL> UPDATE  preferences
  2  SET     result = 'Y'
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

Error starting at line : 637 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     result = 'Y'
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-20003: Cannot add results when the registration has not finished yet!
ORA-06512: przy "BD2C049.PREF_RESULT_TRG", linia 18
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.PREF_RESULT_TRG'

SQL> 
SQL> --------------------------------
SQL> -- TEST TRIGGER PREF_REG_TRG --
SQL> --------------------------------
SQL> 
SQL> UPDATE  registrations
  2  SET     start_date = TO_DATE('1997-01-01', 'YYYY-MM-DD')
  3      ,   end_date = TO_DATE('1997-04-01', 'YYYY-MM-DD')
  4  WHERE registration_code = 'TEST';

1 row updated.

SQL> 
SQL> 
SQL> -- Trying to change order of preferences should not be possible
SQL> -- after the registration ends
SQL> UPDATE  preferences
  2  SET     sequential_number = 3
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

Error starting at line : 656 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     sequential_number = 3
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-20002: Cannot modify preference for closed (or not open yet) registration
ORA-06512: przy "BD2C049.PREF_REG_TRG", linia 23
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.PREF_REG_TRG'

SQL> 
SQL> -- Updating result should be possible even after registration is closed
SQL> UPDATE  preferences
  2  SET     result = 'Y'
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

1 row updated.

SQL> 
SQL> -- Updating points should be possible even after registration is closed
SQL> UPDATE  preferences
  2  SET     points = 100
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

1 row updated.

SQL> 
SQL> ------------------------------------
SQL> -- TEST TRIGGER FKNTM_PREFERENCES --
SQL> ------------------------------------
SQL> 
SQL> -- Test for non-transferability
SQL> -- Updating to previous value is OK
SQL> -- Setting different value should result in an error
SQL> 
SQL> UPDATE  preferences
  2  SET     registration_code = 'TEST' 
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

1 row updated.

SQL> 
SQL> UPDATE  preferences
  2  SET     registration_code = 'TESTF' 
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

Error starting at line : 694 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     registration_code = 'TESTF' 
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-20225: Non Transferable FK constraint  on table PREFERENCES is violated
ORA-06512: przy "BD2C049.FKNTM_PREFERENCES", linia 2
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.FKNTM_PREFERENCES'

SQL> 
SQL> UPDATE  preferences
  2  SET     course_code = 'TEST1' 
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

1 row updated.

SQL> 
SQL> UPDATE  preferences
  2  SET     course_code = 'TEST2' 
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

Error starting at line : 708 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     course_code = 'TEST2' 
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-20225: Non Transferable FK constraint  on table PREFERENCES is violated
ORA-06512: przy "BD2C049.FKNTM_PREFERENCES", linia 2
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.FKNTM_PREFERENCES'

SQL> 
SQL> UPDATE  preferences
  2  SET     candidate_id = 98
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

1 row updated.

SQL> 
SQL> UPDATE  preferences
  2  SET     candidate_id = 99
  3  WHERE   registration_code = 'TEST' 
  4      AND course_code = 'TEST1' 
  5      AND candidate_id = 98
  6  ;

Error starting at line : 722 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
UPDATE  preferences
SET     candidate_id = 99
WHERE   registration_code = 'TEST' 
    AND course_code = 'TEST1' 
    AND candidate_id = 98
Error report -
ORA-20225: Non Transferable FK constraint  on table PREFERENCES is violated
ORA-06512: przy "BD2C049.FKNTM_PREFERENCES", linia 2
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.FKNTM_PREFERENCES'

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                          TEST DELETE ON CANDIDATES                         --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT  candidate_id
  2      ,   first_name
  3      ,   family_name
  4      ,   registration_code
  5      ,   course_code
  6      ,   sequential_number
  7      ,   start_date
  8      ,   end_date
  9  FROM    candidates
 10  JOIN    preferences
 11      USING(candidate_id)
 12  JOIN    registrations
 13      USING(registration_code)
 14  WHERE   candidate_id < 100;

CANDIDATE_ID FIRST_NAME           FAMILY_NAME               REGIS COURSE SEQUENTIAL_NUMBER START_DA END_DATE
------------ -------------------- ------------------------- ----- ------ ----------------- -------- --------
          98 Jacob                Tested                    TEST  TEST1                  1 97/01/01 97/04/01
          98 Jacob                Tested                    TEST  TEST2                  2 97/01/01 97/04/01
          99 Johny                Test                      TEST  TEST1                  1 97/01/01 97/04/01

SQL> 
SQL> INSERT INTO candidates (
  2          candidate_id
  3      ,   email
  4      ,   birth_date
  5      ,   first_name
  6      ,   family_name
  7      ,   country
  8      ,   city
  9      ,   postal_code
 10      ,   home_number
 11  )
 12  VALUES  (97
 13      ,   'Test.Test.987@example.com'
 14      ,   TO_DATE('2001-04-11', 'YYYY-MM-DD')
 15      ,   'Test'
 16      ,   'Test'
 17      ,   'Poland'
 18      ,   'Warsaw'
 19      ,   '96-102'
 20      ,   '27'
 21  );

1 row inserted.

SQL> 
SQL> DELETE FROM candidates 
  2  WHERE   candidate_id = 97;

1 row deleted.

SQL> 
SQL> -----------------------------------------------------
SQL> -- TEST TRIGGER PREF_REG_TRG AND ON DELETE CASCADE --
SQL> -----------------------------------------------------
SQL> 
SQL> -- Cannot delete candidate that has placed his preferences for offers 
SQL> -- in registrations that are closed
SQL> DELETE FROM candidates 
  2  WHERE   candidate_id = 99;

Error starting at line : 779 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
DELETE FROM candidates 
WHERE   candidate_id = 99
Error report -
ORA-20002: Cannot delete preference from closed (or not open yet) registration
ORA-06512: przy "BD2C049.PREF_REG_TRG", linia 21
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.PREF_REG_TRG'

SQL> 
SQL> UPDATE  registrations
  2  SET     start_date = ADD_MONTHS(SYSDATE, -1)
  3      ,   end_date = ADD_MONTHS(SYSDATE, 1)
  4  WHERE   registration_code = 'TEST';

1 row updated.

SQL> 
SQL> -- Deletion of candidate and his preferences for open registration
SQL> -- is allowed
SQL> DELETE FROM candidates 
  2  WHERE   candidate_id = 99;

1 row deleted.

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                         TEST DELETE ON PREFERENCES                         --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT  candidate_id
  2      ,   first_name
  3      ,   family_name
  4      ,   registration_code
  5      ,   course_code
  6      ,   sequential_number
  7      ,   start_date
  8      ,   end_date
  9  FROM    candidates
 10  JOIN    preferences
 11      USING(candidate_id)
 12  JOIN    registrations
 13      USING(registration_code)
 14  WHERE   candidate_id < 100;

CANDIDATE_ID FIRST_NAME           FAMILY_NAME               REGIS COURSE SEQUENTIAL_NUMBER START_DA END_DATE
------------ -------------------- ------------------------- ----- ------ ----------------- -------- --------
          98 Jacob                Tested                    TEST  TEST1                  1 22/04/20 22/06/20
          98 Jacob                Tested                    TEST  TEST2                  2 22/04/20 22/06/20

SQL> 
SQL> -------------------------------
SQL> -- TEST TRIGGER PREF_REG_TRG --
SQL> -------------------------------
SQL> 
SQL> -- Deletion of preference from open registration should be possible
SQL> DELETE FROM preferences
  2  WHERE   candidate_id = 98
  3      AND course_code = 'TEST1';

1 row deleted.

SQL> 
SQL> UPDATE  registrations
  2  SET     start_date = TO_DATE('1997-01-01', 'YYYY-MM-DD')
  3      ,   end_date = TO_DATE('1997-04-01', 'YYYY-MM-DD')
  4  WHERE registration_code = 'TEST';

1 row updated.

SQL> 
SQL> -- Cannot delete preference from closed registration
SQL> DELETE FROM preferences
  2  WHERE   candidate_id = 98
  3      AND course_code = 'TEST2';

Error starting at line : 826 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
DELETE FROM preferences
WHERE   candidate_id = 98
    AND course_code = 'TEST2'
Error report -
ORA-20002: Cannot delete preference from closed (or not open yet) registration
ORA-06512: przy "BD2C049.PREF_REG_TRG", linia 21
ORA-04088: b³¹d w trakcie wykonywania wyzwalacza 'BD2C049.PREF_REG_TRG'

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                            TEST DELETE ON OFFERS                           --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT *
  2  FROM offers
  3  LEFT JOIN preferences
  4      USING(course_code, registration_code)
  5  WHERE course_code IN ('TEST1', 'TEST2');

COURSE REGIS AVAILABLE_SLOTS CANDIDATE_ID SEQUENTIAL_NUMBER R     POINTS
------ ----- --------------- ------------ ----------------- - ----------
TEST2  TEST                1           98                 2             
TEST1  TESTF             100                                            
TEST1  99S               101                                            
TEST1  TEST              100                                            

SQL> 
SQL> DELETE FROM offers 
  2  WHERE   registration_code = '99S'
  3      AND course_code = 'TEST1';

1 row deleted.

SQL> 
SQL> -- Deletion of offer with submitted preferences should not be possible
SQL> DELETE FROM offers 
  2  WHERE   registration_code = 'TEST'
  3      AND course_code = 'TEST2';

Error starting at line : 845 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
DELETE FROM offers 
WHERE   registration_code = 'TEST'
    AND course_code = 'TEST2'
Error report -
ORA-02292: naruszono wiêzy spójnoœci (BD2C049.PREF_OFR_FK) - znaleziono rekord podrzêdny

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                            TEST DELETE ON COURSES                          --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT course_code
  2      ,   name
  3      ,   registration_code
  4      ,   available_slots
  5  FROM courses
  6  LEFT JOIN offers
  7      USING(course_code)
  8  WHERE course_code IN ('TEST1', 'TEST2', '1', '2', '3', '4');

COURSE NAME                                                                                                 REGIS AVAILABLE_SLOTS
------ ---------------------------------------------------------------------------------------------------- ----- ---------------
TEST1  Science of Testing, Finding Buggs and Debugging                                                      TEST              100
TEST2  Mechatronics of Vehicles, Construction Machinery and Computer Science                                TEST                1
TEST1  Science of Testing, Finding Buggs and Debugging                                                      TESTF             100
2      Doctorate                                                                                                                 
1      Bachelor                                                                                                                  
4      Master                                                                                                                    
3      Engineer                                                                                                                  

7 rows selected. 

SQL> 
SQL> DELETE FROM courses
  2  WHERE   course_code = '4';

1 row deleted.

SQL> 
SQL> -- Deletion of course with submitted offers should not be possible
SQL> DELETE FROM courses
  2  WHERE   course_code = 'TEST1';

Error starting at line : 866 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
DELETE FROM courses
WHERE   course_code = 'TEST1'
Error report -
ORA-02292: naruszono wiêzy spójnoœci (BD2C049.OFR_CRS_FK) - znaleziono rekord podrzêdny

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> --                        TEST DELETE ON REGISTRATIONS                        --
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT *
  2  FROM registrations
  3  LEFT JOIN offers
  4      USING(registration_code)
  5  WHERE registration_code IN ('TEST', 'TESTF', '99S');

REGIS START_DA END_DATE COURSE AVAILABLE_SLOTS
----- -------- -------- ------ ---------------
TEST  97/01/01 97/04/01 TEST1              100
TEST  97/01/01 97/04/01 TEST2                1
TESTF 22/05/20 30/09/20 TEST1              100
99S   99/02/01 99/03/01                       

SQL> 
SQL> DELETE FROM registrations
  2  WHERE   registration_code = '99S';

1 row deleted.

SQL> 
SQL> 
SQL> -- Deletion of registration with submitted offers should not be possible
SQL> DELETE FROM registrations
  2  WHERE   registration_code = 'TEST';

Error starting at line : 884 File @ C:\Users\Bart³omiej Krawczyk\Documents\Studia\BD2\projekt\ddl\dml_script.sql
In command -
DELETE FROM registrations
WHERE   registration_code = 'TEST'
Error report -
ORA-02292: naruszono wiêzy spójnoœci (BD2C049.OFR_REG_FK) - znaleziono rekord podrzêdny

SQL> 
SQL> -- Clean after the tests
SQL> ROLLBACK TO SAVEPOINT before_tests;

Rollback complete.

SQL> 
SQL> spool off
