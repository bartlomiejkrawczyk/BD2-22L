SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Every candidate registers giving their personal information.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- Number of all the candidates accross every registration
SQL> 
SQL> SELECT  COUNT(*) NUMBER_OF_CANDIDATES
  2  FROM    candidates;

NUMBER_OF_CANDIDATES
--------------------
                1137

SQL> 
SQL> -- Personal Information
SQL> 
SQL> SELECT  candidate_id
  2      ,   first_name
  3      ,   second_name
  4      ,   family_name
  5      ,   birth_date
  6      ,   pesel
  7  FROM    candidates
  8  FETCH FIRST 20 ROWS ONLY;

CANDIDATE_ID FIRST_NAME           SECOND_NAME          FAMILY_NAME               BIRTH_DA PESEL      
------------ -------------------- -------------------- ------------------------- -------- -----------
         323 Ericberto            Briam                Hopes                     32/04/15 76440339762
         324 Romar                Jemal                Spore                     82/04/02            
         325 Cyrena               Emi                  Cornutt                   33/07/27            
         326 Pearson                                   Shulick                   43/11/23 78042950870
         327 Hanan                Keelie               Zerby                     37/12/13 90865351885
         328 Alishia                                   Bionda                    81/05/02 42266686172
         329 Shlomo               Luqman               Okoli                     73/10/09 70919422482
         330 Martellis            Altagracia           Claypole                  25/07/04 11762787793
         331 Kea                                       Balderston                40/05/24 20827482967
         332 Cyrstal                                   Or                        00/02/07            
         333 Carolee              Jenni                Sandles                   67/05/14 46411815022
         334 Lachell                                   Pichon                    09/08/28 97703212412
         335 Seng                 Anthoney             Grboyan                   78/01/14            
         336 Paulette             Graylon              Cesena                    62/11/24            
         337 Monifa               Tiphani              Ambers                    67/01/27 44432548685
         338 Tilla                                     Brodzik                   20/08/21            
         339 Deniesha                                  Schwier                   74/07/03 77403605726
         340 Jenee                Malka                Dipippo                   89/11/04            
         341 Kylene               Matisha              Etheredge                 62/02/22 66155077187
         342 Iyanna               Mitul                Asby                      53/11/02 15746419584

20 rows selected. 

SQL> 
SQL> -- Contact Information
SQL> 
SQL> SELECT  candidate_id
  2      ,   phone_number
  3      ,   email
  4  FROM    candidates
  5  FETCH FIRST 20 ROWS ONLY;

CANDIDATE_ID PHONE_NUMBER  EMAIL                                                                                               
------------ ------------- ----------------------------------------------------------------------------------------------------
         323 +24324755718  Ericberto.Hopes.614@example.com                                                                     
         324               Romar.Spore.1469@pw.edu.pl                                                                          
         325               Cyrena.Cornutt.267@example.com                                                                      
         326 +100836321153 Pearson.Shulick.569@pw.edu.pl                                                                       
         327 +37854599551  Hanan.Zerby.405@o2.pl                                                                               
         328               Alishia.Bionda.1727@example.com                                                                     
         329 +3255203741   Shlomo.Okoli.343@o2.pl                                                                              
         330 +77166427813  Martellis.Claypole.1750@example.com                                                                 
         331 +47775178153  Kea.Balderston.1519@gmail.com                                                                       
         332               Cyrstal.Or.277@gmail.com                                                                            
         333 +55720208018  Carolee.Sandles.1482@pw.edu.pl                                                                      
         334 +39389678046  Lachell.Pichon.1820@youtube.com                                                                     
         335 +16219037384  Seng.Grboyan.1474@o2.pl                                                                             
         336               Paulette.Cesena.1443@o2.pl                                                                          
         337 +15527950650  Monifa.Ambers.247@youtube.com                                                                       
         338 +45335421603  Tilla.Brodzik.1883@pw.edu.pl                                                                        
         339 +19318050987  Deniesha.Schwier.963@pw.edu.pl                                                                      
         340               Jenee.Dipippo.1223@pw.edu.pl                                                                        
         341 +39899006727  Kylene.Etheredge.168@youtube.com                                                                    
         342               Iyanna.Asby.1284@wp.pl                                                                              

20 rows selected. 

SQL> 
SQL> -- Registered Address
SQL> 
SQL> SELECT  candidate_id
  2      ,   country
  3      ,   voivodeship
  4      ,   city
  5      ,   postal_code
  6      ,   street
  7      ,   home_number
  8      ,   apartment_number
  9  FROM    candidates
 10  FETCH FIRST 20 ROWS ONLY;

CANDIDATE_ID COUNTRY                                            VOIVODESHIP                                        CITY                                               POSTAL_COD STREET                                                                           HOME_N APART
------------ -------------------------------------------------- -------------------------------------------------- -------------------------------------------------- ---------- -------------------------------------------------------------------------------- ------ -----
         323 Luxembourg                                                                                            CoralTerrace                                       32-988                                                                                      832M        
         324 Georgia                                            Warminsko-Mazurskie                                Arbutus                                            992-372    Los Robles Avenue North                                                          69W    381B 
         325 Egypt                                              Podlaskie                                          Heeia                                              106-855    Velvet Way                                                                       6X          
         326 Cameroon                                                                                              RoundRock                                          357-747    Route 926                                                                        962E        
         327 Luxembourg                                         Wielkopolskie                                      Foresthill                                         361-929                                                                                     85B    309I 
         328 Netherlands                                        Opolskie                                           Tucumcari                                          855-722                                                                                     439X   207X 
         329 Sierra Leone                                                                                          TintonFalls                                        96-265                                                                                      246W   38O  
         330 Tonga                                              Wielkopolskie                                      Isanti                                             424-475                                                                                     111U        
         331 Malawi                                             Podkarpackie                                       Carrington                                         800-986    Cherry Lane West                                                                 147C   511R 
         332 Sierra Leone                                       Kujawsko-Pomorskie                                 Bruceton                                           881-714                                                                                     373P   654X 
         333 Luxembourg                                         Zachodniopomorskie                                 Charlevoix                                         449-378    Keswick Grove Lane                                                               334T        
         334 Congo                                                                                                 Albion                                             342-799    Priority Court                                                                   72V         
         335 Ghana                                              Warminsko-Mazurskie                                Malakoff                                           543-154                                                                                     330E   863E 
         336 Grenada                                            Mazowieckie                                        EastJordan                                         297-38     Meyer Court North                                                                447C   886O 
         337 Hungary                                            Slaskie                                            Guthrie                                            743-602                                                                                     112T   60D  
         338 Gabon                                                                                                 Avenel                                             322-154    64th Place NE                                                                    209P   688V 
         339 Fiji                                               Zachodniopomorskie                                 PennEstates                                        964-57     Lindley Road                                                                     333D   477R 
         340 Tuvalu                                             Lubuskie                                           Carbonville                                        828-836                                                                                     135N        
         341 San Marino                                         Dolnoslaskie                                       Rosepine                                           659-384    Esmond Street                                                                    427V   397D 
         342 Brunei                                                                                                NorthAdams                                         750-675    Halsey Place                                                                     37A    126V 

20 rows selected. 

SQL> 
SQL> -- Optional Information Given
SQL> 
SQL> SELECT  candidate_id
  2      ,   pesel
  3      ,   phone_number
  4      ,   second_name
  5      ,   voivodeship
  6      ,   street
  7      ,   apartment_number
  8  FROM    candidates
  9  WHERE   pesel IS NOT NULL
 10      AND phone_number IS NOT NULL
 11      AND second_name IS NOT NULL
 12      AND voivodeship IS NOT NULL
 13      AND street IS NOT NULL
 14      AND apartment_number IS NOT NULL
 15  ;

CANDIDATE_ID PESEL       PHONE_NUMBER  SECOND_NAME          VOIVODESHIP                                        STREET                                                                           APART
------------ ----------- ------------- -------------------- -------------------------------------------------- -------------------------------------------------------------------------------- -----
         341 66155077187 +39899006727  Matisha              Dolnoslaskie                                       Esmond Street                                                                    397D 
         892 86325388762 +84526260640  Omar                 Opolskie                                           Normandy Street                                                                  327U 
         578 94955695851 +38318153765  Lakara               Podlaskie                                          Boggs Lane                                                                       975U 
         579 40212854252 +53852579363  Jemma                Kujawsko-Pomorskie                                 Tennessee Avenue North                                                           672M 
         595 20330291058 +48571517690  Bryden               Lodzkie                                            Mill Creek Road                                                                  38B  
         604 70743706636 +99390566632  Kami                 Opolskie                                           Dulcimer Lane                                                                    36V  
         690 64842390857 +47432540235  Kijuana              Warminsko-Mazurskie                                Syracuse Court South                                                             776H 
         868 35525986819 +30666322887  Teneisha             Dolnoslaskie                                       Upper Gulph Road                                                                 875C 
         187 55450190407 +10794632786  Devonna              Zachodniopomorskie                                 Etching Overlook                                                                 170I 
         281 44532658132 +1990827609   Sander               Swietokrzyskie                                     Ellison Avenue South                                                             779G 
         308 49986385722 +18122576951  Reginaldo            Swietokrzyskie                                     Weightman Street                                                                 209V 
         972 50696998928 +56560582452  Yamil                Warminsko-Mazurskie                                Pear Shape Lane                                                                  748G 
        1114 45890705143 +86807435608  Carrieann            Lodzkie                                            Shelby Way                                                                       636W 
        1174 73333315259 +80646464268  Natosha              Podkarpackie                                       Shire Mill Road                                                                  555Q 
        1208 33842201307 +48428792224  Jansen               Lubuskie                                           Oak Terrace                                                                      879O 
        1210 33673037468 +9928507686   Jamise               Kujawsko-Pomorskie                                 Harford Place                                                                    265I 

16 rows selected. 

SQL> 
SQL> -- Optional Information NOT Given
SQL> 
SQL> SELECT  candidate_id
  2      ,   pesel
  3      ,   phone_number
  4      ,   second_name
  5      ,   voivodeship
  6      ,   street
  7      ,   apartment_number
  8  FROM    candidates
  9  WHERE   pesel IS NULL
 10      AND phone_number IS NULL
 11      AND second_name IS NULL
 12      AND voivodeship IS NULL
 13      AND street IS NULL
 14      AND apartment_number IS NULL
 15  ;

CANDIDATE_ID PESEL       PHONE_NUMBER  SECOND_NAME          VOIVODESHIP                                        STREET                                                                           APART
------------ ----------- ------------- -------------------- -------------------------------------------------- -------------------------------------------------------------------------------- -----
         343                                                                                                                                                                                         
         349                                                                                                                                                                                         
         442                                                                                                                                                                                         
         443                                                                                                                                                                                         
         568                                                                                                                                                                                         
         584                                                                                                                                                                                         
         620                                                                                                                                                                                         
         772                                                                                                                                                                                         
         776                                                                                                                                                                                         
         196                                                                                                                                                                                         
         262                                                                                                                                                                                         
        1032                                                                                                                                                                                         
        1142                                                                                                                                                                                         
        1157                                                                                                                                                                                         
        1190                                                                                                                                                                                         

15 rows selected. 

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Every candidate registers specifying up to 3 choosen courses of study from 
SQL> -- university offer.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- Number of placed preferences in a given registration
SQL> 
SQL> SELECT  first_name
  2      ,   second_name
  3      ,   family_name
  4      ,   registration_code
  5      ,   COUNT(*) PREFERENCES_IN_REGISTRATION
  6  FROM    candidates
  7  JOIN    preferences 
  8      USING (candidate_id)
  9  GROUP BY candidate_id
 10      ,   registration_code
 11      ,   first_name
 12      ,   second_name
 13      ,   family_name
 14  ORDER BY candidate_id ASC
 15      ,   registration_code DESC
 16  FETCH FIRST 20 ROWS ONLY;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               REGIS PREFERENCES_IN_REGISTRATION
-------------------- -------------------- ------------------------- ----- ---------------------------
Serina                                    Larick                    16W                             1
Maribel                                   Filary                    20W                             3
Maribel                                   Filary                    17W                             2
Maribel                                   Filary                    10W                             1
Raelynn              Mikenna              Nobriga                   15S                             1
Raelynn              Mikenna              Nobriga                   14S                             3
Teia                 Deirdre              Brigges                   16W                             1
Teia                 Deirdre              Brigges                   14S                             3
Neghan               Legrande             Romas                     22W                             3
Neghan               Legrande             Romas                     22S                             2
Neghan               Legrande             Romas                     18S                             2
Tyffani                                   Curi                      20W                             1
Tyffani                                   Curi                      20S                             2
Asael                                     Krzyminski                21S                             3
Silver               Elly                 Lafleche                  21S                             2
Sahira                                    Meehan                    21S                             1
Sahira                                    Meehan                    19S                             2
Sahira                                    Meehan                    17W                             3
Jeana                Crystel              Larcade                   14W                             2
Jeana                Crystel              Larcade                   10S                             2

20 rows selected. 

SQL> 
SQL> -- Check if number of chosen courses does not exceed 3 courses per registration
SQL> 
SQL> SELECT  candidate_id
  2      ,   registration_code
  3      ,   COUNT(*) PREFERENCES_IN_REGISTRATION
  4  FROM    preferences
  5  GROUP BY candidate_id
  6      ,   registration_code
  7  HAVING  COUNT(*) > 3;
no rows selected
SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- The order determines the preferences.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> SELECT  cand.first_name
  2      ,   cand.second_name
  3      ,   cand.family_name
  4      ,   registration_code
  5      ,   course_code
  6      ,   crs.name
  7      ,   pref.sequential_number
  8  FROM    candidates cand
  9  JOIN    preferences pref
 10      USING(candidate_id)
 11  JOIN    courses crs
 12      USING(course_code)
 13  WHERE   candidate_id = 101
 14  ORDER BY registration_code
 15      ,   pref.sequential_number
 16  ;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               REGIS COURSE NAME                                                                                                 SEQUENTIAL_NUMBER
-------------------- -------------------- ------------------------- ----- ------ ---------------------------------------------------------------------------------------------------- -----------------
Maribel                                   Filary                    10W   SS130  Science in Health Informatics                                                                                        1
Maribel                                   Filary                    17W   CM32   Computer Applications                                                                                                1
Maribel                                   Filary                    17W   ST129  Science in Government Contracts                                                                                      2
Maribel                                   Filary                    20W   LE77   Letters                                                                                                              1
Maribel                                   Filary                    20W   SE75   Studies in Law                                                                                                       2
Maribel                                   Filary                    20W   ST129  Science in Government Contracts                                                                                      3

6 rows selected. 

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Recruitment takes place twice a year.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- All the registrations
SQL> 
SQL> SELECT  registration_code
  2      ,   start_date
  3      ,   end_date
  4  FROM    registrations;

REGIS START_DA END_DATE
----- -------- --------
10W   10/07/01 10/07/28
10S   10/02/01 10/02/28
11W   11/07/01 11/07/28
11S   11/02/01 11/02/28
12W   12/07/01 12/07/28
12S   12/02/01 12/02/28
13W   13/07/01 13/07/28
13S   13/02/01 13/02/28
14W   14/07/01 14/07/28
14S   14/02/01 14/02/28
15W   15/07/01 15/07/28
15S   15/02/01 15/02/28
16W   16/07/01 16/07/28
16S   16/02/01 16/02/28
17W   17/07/01 17/07/28
17S   17/02/01 17/02/28
18W   18/07/01 18/07/28
18S   18/02/01 18/02/28
19W   19/07/01 19/07/28
19S   19/02/01 19/02/28
20W   20/07/01 20/07/28
20S   20/02/01 20/02/28
21W   21/07/01 21/07/28
21S   21/02/01 21/02/28
22W   22/07/01 22/07/28
22S   22/02/01 22/02/28

26 rows selected. 

SQL> 
SQL> -- Registrations from year 2022
SQL> 
SQL> SELECT  registration_code
  2      ,   start_date
  3      ,   end_date
  4  FROM    registrations
  5  WHERE   EXTRACT(YEAR FROM start_date) = 2022;

REGIS START_DA END_DATE
----- -------- --------
22W   22/07/01 22/07/28
22S   22/02/01 22/02/28

SQL> 
SQL> -- Count all the registrations per year
SQL> 
SQL> SELECT  EXTRACT(YEAR FROM start_date) YEAR
  2      ,   COUNT(*) REGISTRATIONS_IN_A_YEAR
  3  FROM    registrations
  4  GROUP BY EXTRACT(YEAR FROM start_date)
  5  ORDER BY YEAR;

      YEAR REGISTRATIONS_IN_A_YEAR
---------- -----------------------
      2010                       2
      2011                       2
      2012                       2
      2013                       2
      2014                       2
      2015                       2
      2016                       2
      2017                       2
      2018                       2
      2019                       2
      2020                       2
      2021                       2
      2022                       2

13 rows selected. 

SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- The university course offer changes with time.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- List of 20 courses
SQL> SELECT  course_code
  2      ,   name
  3      ,   degree
  4      ,   CAST(
  5              CASE WHEN description IS NOT NULL THEN
  6                  SUBSTR(description, 0, 100) || '...'
  7              ELSE 
  8                  NULL
  9              END 
 10              AS VARCHAR2(103)
 11          ) DESCRIPTION
 12  FROM courses
 13  FETCH FIRST 20 ROWS ONLY;

COURSE NAME                                                                                                 D DESCRIPTION                                                                                            
------ ---------------------------------------------------------------------------------------------------- - -------------------------------------------------------------------------------------------------------
TO152  Technology                                                                                           D Ipsum porro dolor quaerat. Ipsum labore voluptatem quiquia neque adipisci sit. Sed labore ut est non...
TE153  Theology                                                                                             M Aliquam non dolorem consectetur amet. Voluptatem quaerat sit neque modi etincidunt amet amet. Volupt...
UN154  Urban Planning                                                                                       B Neque modi neque etincidunt dolore modi dolore. Ipsum labore dolor ipsum dolor tempora adipisci. Ut ...
VA155  Veterinary Science                                                                                   M Velit porro sit est adipisci dolore quiquia ipsum. Velit dolore sed quaerat quiquia. Eius ut est qua...
SQ139  Science in Quality Assurance                                                                         E Ipsum porro consectetur est ipsum dolor velit porro. Ut dolore labore dolor dolorem ipsum. Aliquam e...
SE140  Science in Risk Management                                                                           B                                                                                                        
SM141  Science in Supply Chain Management                                                                   D                                                                                                        
SN142  Science in Teaching                                                                                  D                                                                                                        
SC143  Science in Taxation                                                                                  B                                                                                                        
SS144  Social Science                                                                                       D Quaerat consectetur quiquia ipsum eius quaerat consectetur. Aliquam est consectetur modi non dolor a...
SO145  Social Work                                                                                          M Eius quiquia ipsum non porro porro magnam. Dolor sit quiquia neque sed est. Labore quiquia numquam e...
SR146  Software Engineering                                                                                 M                                                                                                        
ST147  Statistics                                                                                           B Tempora dolore sed tempora etincidunt porro sit tempora. Non etincidunt etincidunt dolorem labore qu...
SR148  Strategic Studies                                                                                    E Consectetur velit sed neque tempora modi quaerat. Ipsum ipsum aliquam ut consectetur tempora velit. ...
ST149  Studies                                                                                              M Eius etincidunt dolorem magnam dolore velit dolorem. Consectetur amet voluptatem etincidunt. Tempora...
SG150  Surgery                                                                                              E                                                                                                        
TI151  Theological Studies                                                                                  M Quaerat consectetur labore modi. Quiquia numquam numquam voluptatem sit labore eius etincidunt. Modi...
AE1    Accounting and Information Systems                                                                   E                                                                                                        
AA2    Advanced Study                                                                                       M Aliquam dolor ut quisquam consectetur adipisci ipsum aliquam. Porro labore voluptatem dolor adipisci...
AO3    Agricultural Economics                                                                               B Sit sit eius sit non velit ut quiquia. Adipisci ipsum eius est. Quaerat sed magnam consectetur. Quae...

20 rows selected. 

SQL> 
SQL> -- Courses and their number of occurences in all the registrations
SQL> 
SQL> SELECT  course_code
  2      ,   crs.name
  3      ,   COUNT(*) OCCURRENCES
  4  FROM    courses crs
  5  JOIN    offers ofr
  6      USING(course_code)
  7  GROUP BY course_code, crs.name
  8  FETCH FIRST 20 ROWS ONLY;

COURSE NAME                                                                                                 OCCURRENCES
------ ---------------------------------------------------------------------------------------------------- -----------
LC76   Landscape Architecture                                                                                        16
MC90   Military Art and Science                                                                                      11
ME80   Management                                                                                                    12
MP86   Mathematics and Philosophy                                                                                     9
SC131  Science in Human Resource Development                                                                         12
SE123  Science in Cyber Security                                                                                     15
SE140  Science in Risk Management                                                                                    13
AN11   Arts in Archives and Records Management                                                                       13
AT9    Architecture                                                                                                  12
DV40   Development Economics                                                                                         10
EN42   Economics                                                                                                     14
ET44   Educational Technology                                                                                        17
SI126  Science in Development Administration                                                                         12
SN121  Science in Clinical Epidemiology                                                                              12
SO115  Sacred Theology                                                                                               17
SO124  Science in Education                                                                                          14
SQ139  Science in Quality Assurance                                                                                  15
SS130  Science in Health Informatics                                                                                 16
PL104  Public Health                                                                                                 11
PN105  Public Management                                                                                             14

20 rows selected. 

SQL> 
SQL> -- Occurrence of a course throughout all the registrations
SQL> 
SQL> SELECT  crs.course_code
  2      ,   crs.name
  3      ,   reg.registration_code
  4      ,   start_date
  5      ,   end_date
  6  FROM    registrations reg
  7  LEFT JOIN offers ofr
  8      ON  reg.registration_code = ofr.registration_code 
  9      AND ofr.course_code = (
 10          SELECT  course_code 
 11          FROM    courses 
 12          ORDER BY course_code DESC 
 13          FETCH FIRST 1 ROW ONLY
 14      )
 15  LEFT JOIN courses crs
 16      ON ofr.course_code = crs.course_code
 17  ORDER BY start_date;

COURSE NAME                                                                                                 REGIS START_DA END_DATE
------ ---------------------------------------------------------------------------------------------------- ----- -------- --------
                                                                                                            10S   10/02/01 10/02/28
                                                                                                            10W   10/07/01 10/07/28
VA155  Veterinary Science                                                                                   11S   11/02/01 11/02/28
                                                                                                            11W   11/07/01 11/07/28
                                                                                                            12S   12/02/01 12/02/28
                                                                                                            12W   12/07/01 12/07/28
                                                                                                            13S   13/02/01 13/02/28
                                                                                                            13W   13/07/01 13/07/28
                                                                                                            14S   14/02/01 14/02/28
VA155  Veterinary Science                                                                                   14W   14/07/01 14/07/28
VA155  Veterinary Science                                                                                   15S   15/02/01 15/02/28
VA155  Veterinary Science                                                                                   15W   15/07/01 15/07/28
VA155  Veterinary Science                                                                                   16S   16/02/01 16/02/28
                                                                                                            16W   16/07/01 16/07/28
VA155  Veterinary Science                                                                                   17S   17/02/01 17/02/28
VA155  Veterinary Science                                                                                   17W   17/07/01 17/07/28
VA155  Veterinary Science                                                                                   18S   18/02/01 18/02/28
                                                                                                            18W   18/07/01 18/07/28
                                                                                                            19S   19/02/01 19/02/28
VA155  Veterinary Science                                                                                   19W   19/07/01 19/07/28
                                                                                                            20S   20/02/01 20/02/28
VA155  Veterinary Science                                                                                   20W   20/07/01 20/07/28
                                                                                                            21S   21/02/01 21/02/28
VA155  Veterinary Science                                                                                   21W   21/07/01 21/07/28
VA155  Veterinary Science                                                                                   22S   22/02/01 22/02/28
VA155  Veterinary Science                                                                                   22W   22/07/01 22/07/28

26 rows selected. 

SQL> 
SQL> 
SQL> --------------------------------------------------------------------------------
SQL> -- Candidate who has not been admitted to study in a registration may start
SQL> -- in the next registrations.
SQL> --------------------------------------------------------------------------------
SQL> 
SQL> -- Candidates and their number of tries in registrations
SQL> 
SQL> SELECT  first_name
  2      ,   second_name
  3      ,   family_name
  4      ,   COUNT(DISTINCT registration_code) ATTENDED_REGISTRATIONS
  5  FROM    candidates
  6  JOIN    preferences 
  7      USING (candidate_id)
  8  GROUP BY candidate_id
  9      ,   first_name
 10      ,   second_name
 11      ,   family_name
 12  ORDER BY candidate_id ASC
 13  FETCH FIRST 20 ROWS ONLY;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               ATTENDED_REGISTRATIONS
-------------------- -------------------- ------------------------- ----------------------
Serina                                    Larick                                         1
Maribel                                   Filary                                         3
Raelynn              Mikenna              Nobriga                                        2
Teia                 Deirdre              Brigges                                        2
Neghan               Legrande             Romas                                          3
Tyffani                                   Curi                                           2
Asael                                     Krzyminski                                     1
Silver               Elly                 Lafleche                                       1
Sahira                                    Meehan                                         3
Jeana                Crystel              Larcade                                        2
Risha                                     Suchocki                                       2
Ayme                                      Klukas                                         2
Devlin                                    Mabary                                         1
Nichols              Steele               Arslanian                                      3
Glenn                                     Legaspi                                        3
Amaryllis                                 Zubia                                          1
Clementine           Ladana               Olesky                                         3
Leotis                                    Colindres                                      1
Savvas                                    Olquin                                         2
Marni                Romney               Katnik                                         1

20 rows selected. 

SQL> 
SQL> -- Candidates and registrations they attended
SQL> 
SQL> SELECT  first_name
  2      ,   second_name
  3      ,   family_name
  4      ,   registration_code
  5  FROM    candidates
  6  JOIN    preferences 
  7      USING (candidate_id)
  8  GROUP BY candidate_id
  9      ,   registration_code
 10      ,   first_name
 11      ,   second_name
 12      ,   family_name
 13  ORDER BY candidate_id ASC
 14      ,   registration_code
 15  FETCH FIRST 20 ROWS ONLY;

FIRST_NAME           SECOND_NAME          FAMILY_NAME               REGIS
-------------------- -------------------- ------------------------- -----
Serina                                    Larick                    16W  
Maribel                                   Filary                    10W  
Maribel                                   Filary                    17W  
Maribel                                   Filary                    20W  
Raelynn              Mikenna              Nobriga                   14S  
Raelynn              Mikenna              Nobriga                   15S  
Teia                 Deirdre              Brigges                   14S  
Teia                 Deirdre              Brigges                   16W  
Neghan               Legrande             Romas                     18S  
Neghan               Legrande             Romas                     22S  
Neghan               Legrande             Romas                     22W  
Tyffani                                   Curi                      20S  
Tyffani                                   Curi                      20W  
Asael                                     Krzyminski                21S  
Silver               Elly                 Lafleche                  21S  
Sahira                                    Meehan                    17W  
Sahira                                    Meehan                    19S  
Sahira                                    Meehan                    21S  
Jeana                Crystel              Larcade                   10S  
Jeana                Crystel              Larcade                   14W  

20 rows selected. 

SQL> 
SQL> 
SQL> 
SQL> spool off
